{
  "active": false,
  "connections": {
    "When clicking ‘Test workflow’": {
      "main": [
        [
          {
            "node": "Google Drive1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Drive": {
      "main": [
        [
          {
            "node": "Extract from File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI": {
      "ai_embedding": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader": {
      "ai_document": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Recursive Character Text Splitter": {
      "ai_textSplitter": [
        [
          {
            "node": "Default Data Loader",
            "type": "ai_textSplitter",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Split Out1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI1": {
      "ai_embedding": [
        [
          {
            "node": "Supabase Vector Store1",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader1": {
      "ai_document": [
        [
          {
            "node": "Supabase Vector Store1",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Recursive Character Text Splitter1": {
      "ai_textSplitter": [
        [
          {
            "node": "Default Data Loader1",
            "type": "ai_textSplitter",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets": {
      "main": [
        [
          {
            "node": "Supabase Vector Store1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI2": {
      "ai_embedding": [
        [
          {
            "node": "Supabase Vector Store2",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Google Drive1": {
      "main": [
        [
          {
            "node": "Extract from File1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File1": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI3": {
      "ai_embedding": [
        [
          {
            "node": "Supabase Vector Store3",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader2": {
      "ai_document": [
        [
          {
            "node": "Supabase Vector Store3",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Recursive Character Text Splitter2": {
      "ai_textSplitter": [
        [
          {
            "node": "Default Data Loader2",
            "type": "ai_textSplitter",
            "index": 0
          }
        ]
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "Supabase Vector Store3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out1": {
      "main": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-06-14T17:10:30.615Z",
  "id": "wMtTbDlVSj5CSZ7g",
  "isArchived": false,
  "meta": null,
  "name": "Indexação com N8N usando PDF",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        120,
        2080
      ],
      "id": "c9afd9fd-fafd-477f-b72e-87a3d5abff3b",
      "name": "When clicking ‘Test workflow’"
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "https://docs.google.com/document/d/1_TwenP_MGM4bJ6xe_BjIlLfXCu4Mqi8Hg2sffIVlQPg/edit?pli=1&tab=t.0",
          "mode": "url"
        },
        "options": {
          "googleFileConversion": {
            "conversion": {
              "docsToFormat": "text/plain",
              "slidesToFormat": "application/pdf"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        140,
        320
      ],
      "id": "21b364e8-c1ca-4a0a-83af-b871c142a9f4",
      "name": "Google Drive"
    },
    {
      "parameters": {
        "operation": "text",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        440,
        320
      ],
      "id": "1440ca30-9909-44dd-802c-e152b2746f65",
      "name": "Extract from File"
    },
    {
      "parameters": {
        "mode": "insert",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.1,
      "position": [
        1220,
        320
      ],
      "id": "a575d40e-aaa6-4c27-bc50-1065956edf87",
      "name": "Supabase Vector Store"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {
          "dimensions": 1536
        }
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        1000,
        560
      ],
      "id": "43b05576-f4eb-4ec6-851e-c3dc31f88ef7",
      "name": "Embeddings OpenAI"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1,
      "position": [
        1260,
        520
      ],
      "id": "0f82b053-7a76-4b20-b41e-24df2ef3bd38",
      "name": "Default Data Loader"
    },
    {
      "parameters": {
        "chunkSize": 4000,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
      "typeVersion": 1,
      "position": [
        1500,
        700
      ],
      "id": "0b05a5d4-addb-415c-9345-97952ac2074a",
      "name": "Recursive Character Text Splitter"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "012786aa-8174-4718-931b-825730335377",
              "name": "data",
              "value": "={{ $json.data.split('\\n\\n') }}",
              "type": "array"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        440,
        140
      ],
      "id": "48c29674-c552-4734-98db-d50df6506a09",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "jsCode": "// Força desescape real (transforma \\\\n em \\n real)\nconst raw = $json.data.replace(/\\\\\\\\n/g, '\\n').replace(/\\\\\\\\r/g, '');\n\nconst chunks = raw\n  .split(/\\n\\s*\\n/)             // quebra por parágrafos reais\n  .map(chunk => chunk.trim())   // limpa espaços em branco\n  .filter(chunk => chunk.length > 0); // remove vazios\n\nreturn [{ json: { chunks } }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        680,
        320
      ],
      "id": "bcff833e-d639-4493-8af1-d14ecddfc9b9",
      "name": "Code"
    },
    {
      "parameters": {
        "mode": "insert",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.1,
      "position": [
        540,
        1200
      ],
      "id": "0030bcba-a75a-4b9c-99e7-88e125c87b3f",
      "name": "Supabase Vector Store1",
      "executeOnce": false
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {
          "dimensions": 1536
        }
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        420,
        1380
      ],
      "id": "ca32c5a0-03af-4835-8e7d-beb2b418111a",
      "name": "Embeddings OpenAI1"
    },
    {
      "parameters": {
        "jsonMode": "expressionData",
        "jsonData": "=modelo: {{ $json['Modelo do Carro'] }}\nFiltros de ar: {{ $json['Conteúdo'] }}",
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "modelo",
                "value": "={{ $json['Modelo do Carro'].split(' ')[1] }}"
              },
              {
                "name": "marca",
                "value": "={{ $json['Modelo do Carro'].split(' ')[0] }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1,
      "position": [
        620,
        1420
      ],
      "id": "5102ec16-aece-4840-9a36-b5bca6f81da5",
      "name": "Default Data Loader1"
    },
    {
      "parameters": {
        "chunkSize": 4000,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
      "typeVersion": 1,
      "position": [
        640,
        1580
      ],
      "id": "57e751e5-e8be-4444-872c-7ce43a2ef72d",
      "name": "Recursive Character Text Splitter1"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1mFGKTe5cEJDCpbqBBzDlgUKkNbamgiogy82w9QTZAK4/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Página1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mFGKTe5cEJDCpbqBBzDlgUKkNbamgiogy82w9QTZAK4/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        320,
        1200
      ],
      "id": "a821a2ce-aca7-4ce6-a406-35ef025072c7",
      "name": "Google Sheets",
      "executeOnce": false
    },
    {
      "parameters": {
        "mode": "load",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "prompt": "filtros de ar",
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "marca",
                "value": "Hyundai"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.1,
      "position": [
        1140,
        1200
      ],
      "id": "9cbaa7c9-2679-4a33-ab81-99b11ce81dfd",
      "name": "Supabase Vector Store2"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        1160,
        1420
      ],
      "id": "3961be3d-7cb2-4e9d-bd2d-eb3730edf851",
      "name": "Embeddings OpenAI2"
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "https://drive.google.com/file/d/1tcEZkP-szhsywDtqyCV5G90HMHqPOucL/view?pli=1",
          "mode": "url"
        },
        "options": {
          "googleFileConversion": {
            "conversion": {
              "docsToFormat": "text/plain",
              "slidesToFormat": "application/pdf"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        340,
        2080
      ],
      "id": "7f858d2a-d6d8-4e2a-ab81-9bdb38fe76f1",
      "name": "Google Drive1"
    },
    {
      "parameters": {
        "operation": "pdf",
        "options": {
          "joinPages": false
        }
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        560,
        2080
      ],
      "id": "68efacf1-87ed-47c6-9db0-528072ab5870",
      "name": "Extract from File1"
    },
    {
      "parameters": {
        "mode": "insert",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.1,
      "position": [
        1180,
        2080
      ],
      "id": "0b19edb3-bf0e-4303-8734-a339b1db2811",
      "name": "Supabase Vector Store3"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {
          "dimensions": 1536
        }
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        1040,
        2300
      ],
      "id": "05f9ef0f-b36e-483c-a557-299127008362",
      "name": "Embeddings OpenAI3"
    },
    {
      "parameters": {
        "jsonMode": "expressionData",
        "jsonData": "={{ $json.text }}",
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "autor",
                "value": "={{ $('Extract from File1').item.json.info.Author }}"
              },
              {
                "name": "titulo",
                "value": "={{ $('Extract from File1').item.json.info.Title }}"
              },
              {
                "name": "pagina",
                "value": "={{ $itemIndex + 1 }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1,
      "position": [
        1260,
        2320
      ],
      "id": "9ec0d544-f311-4aca-876c-e2a8fbce2158",
      "name": "Default Data Loader2"
    },
    {
      "parameters": {
        "chunkSize": 400,
        "chunkOverlap": 80,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
      "typeVersion": 1,
      "position": [
        1400,
        2520
      ],
      "id": "96114c48-e37a-403a-9150-8dfbade1ed55",
      "name": "Recursive Character Text Splitter2"
    },
    {
      "parameters": {
        "fieldToSplitOut": "text",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        860,
        2080
      ],
      "id": "a1bb1abd-064e-4798-87a9-06b47c22dc1c",
      "name": "Split Out"
    },
    {
      "parameters": {
        "fieldToSplitOut": "chunks",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        920,
        320
      ],
      "id": "2f5997d4-d929-4b45-bb33-9ff94861b6ae",
      "name": "Split Out1"
    },
    {
      "parameters": {
        "content": "# Indexação com Google Docs\n",
        "height": 880,
        "width": 1760,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        0
      ],
      "typeVersion": 1,
      "id": "5091ccc4-9a13-467d-b280-9d26bff07ffc",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "# Indexação com Google Sheets\n",
        "height": 880,
        "width": 1760,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        940
      ],
      "typeVersion": 1,
      "id": "e369d092-dba1-489b-a623-357d2a570f31",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "# Indexação com PDF",
        "height": 880,
        "width": 1760,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        1860
      ],
      "typeVersion": 1,
      "id": "bfbc44ec-a008-4618-b950-1c8d20330af6",
      "name": "Sticky Note2"
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "createdAt": "2025-06-14T17:10:30.615Z",
      "updatedAt": "2025-06-14T17:10:30.615Z",
      "role": "workflow:owner",
      "workflowId": "wMtTbDlVSj5CSZ7g",
      "projectId": "o60HadikmqrvYZ9Z"
    }
  ],
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2025-06-14T17:10:30.615Z",
  "versionId": "34f9a79c-5163-4a20-8061-de72c0fd5df3"
}
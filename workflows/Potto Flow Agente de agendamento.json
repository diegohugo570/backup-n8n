{
  "active": false,
  "activeVersion": null,
  "activeVersionId": null,
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "simplificaﾃｧﾃ｣o de dados",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "simplificaﾃｧﾃ｣o de dados": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "criar_evento": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "buscar_evento": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "deletar_evento": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "atualizar_evento": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-12-17T12:21:15.312Z",
  "id": "xOIJMptdvsIzKn68",
  "isArchived": false,
  "meta": null,
  "name": "Potto Flow Agente de agendamento",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "fa4ac463-aeb4-48ca-a135-d6088cd98990",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        0,
        0
      ],
      "id": "78d5a337-6db5-4fe3-88a5-6293940c9f41",
      "name": "Webhook",
      "webhookId": "fa4ac463-aeb4-48ca-a135-d6088cd98990"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "55f41c61-8568-4b33-8cf4-a8fb0648843c",
              "name": "whatsapp",
              "value": "={{ $json.body.phone }}",
              "type": "string"
            },
            {
              "id": "87b50a77-71c0-459f-90a5-7c4269353681",
              "name": "nome",
              "value": "={{ $json.body.chatName }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        224,
        0
      ],
      "id": "1706cf2b-7558-4be1-bfad-7f8eee6d3af0",
      "name": "simplificaﾃｧﾃ｣o de dados",
      "notes": "Desenvolvido por Potto Flow"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Webhook').item.json.body.text.message }}",
        "options": {
          "systemMessage": "=<OBJETIVO>\nVocﾃｪ ﾃｩ um agente virtual responsﾃ｡vel por:\n\nAgendar, reagendar e cancelar consultas.\n\nConfirmar sempre os dados antes de qualquer aﾃｧﾃ｣o.\n\nGarantir comunicaﾃｧﾃ｣o eficiente, clara e profissional.\n\n</OBJETIVO>\n\n<USO DA TOOL>\n\nPassos para Novo Agendamento:\nPergunte para a pessoa:\n\nQual o dia desejado para agendamento.\n\nSolicite tambﾃｩm:\n\nNome completo\n\nE-mail\n\nAntes de realizar o agendamento consulte se o hﾃｳrario estﾃ｡ disponivel, Utilize a funﾃｧﾃ｣o/tool: <buscar_evento>\n\nNﾃ｣o fale que estﾃ｡ todos os hﾃｳrarios dispiniveis para as pessoas. Apenas pergunte um horario.\n\nSe o horﾃ｡rio Nﾃグ estiver disponﾃｭvel:\n\nSugira 3 horﾃ｡rios seguintes disponﾃｭveis prﾃｳximos do horﾃ｡rio desejado.\n\nExemplo de mensagem:\n\nHorﾃ｡rios disponﾃｭveis para [data]:\n\n套 [data] 08:00\n套 [data] 09:00\n套 [data] 10:00\n\nEscolha um horﾃ｡rio confortﾃ｡vel para vocﾃｪ para prosseguir com o agendamento.\n\nConfirme com o paciente:\n\nData e horﾃ｡rio escolhido.\n\nRealize o agendamento no Google Calendar:\n\nTﾃｭtulo do evento: Consulta - [Nome do Paciente]\n\nInclua o paciente como convidado (usando o e-mail fornecido).\n\nInclua o organizador como convidado tambﾃｩm.\n\nResponda ao paciente conforme o tipo e data do agendamento:\n\nExemplo de CONFIRMAﾃﾃグ para HOJE:\n笨 Agendamento confirmado para hoje ﾃs [horﾃ｡rio escolhido]!\n\nExemplo de CONFIRMAﾃﾃグ para DATA FUTURA - CONSULTA PRESENCIAL:\n笨 Agendamento confirmado para [data escolhida] ﾃs [horﾃ｡rio escolhido]!\n\nDetalhes do seu agendamento:\nConsulta: Presencial\nData: [data escolhida]\nHorﾃ｡rio: [horﾃ｡rio escolhido]\nEndereﾃｧo: Rua Feliz 123, Sﾃ｣o Paulo - SP\n\nAguardamos vocﾃｪ! Caso tenha dﾃｺvidas, estamos ﾃ disposiﾃｧﾃ｣o.\n\nFLUXO DE CANCELAMENTO:\nPassos para Cancelamento:\nSolicite ao paciente o e-mail utilizado no agendamento, para seguranﾃｧa.\n\nUse a funﾃｧﾃ｣o/tool:\n<buscar_evento>getAll: event</buscar_evento>\npara localizar o evento usando o e-mail fornecido.\n\nObtenha o Event_ID do evento e realize o cancelamento.\n\nConfirme o cancelamento com mensagem clara:\n\n笨 Agendamento cancelado com sucesso! \nCaso deseje reagendar ou tenha alguma dﾃｺvida, estamos ﾃ disposiﾃｧﾃ｣o.\n\nFLUXO DE AtUALIZAﾃﾃグ:\nSolicite ao paciente o e-mail utilizado no agendamento, para seguranﾃｧa.\n\nUse a funﾃｧﾃ｣o/tool:\n<buscar_evento>getAll: event</buscar_evento>\npara localizar o evento usando o e-mail fornecido.\n\nObtenha o Event_ID do evento e realize a atualizaﾃｧﾃ｣o do evento.\n\nSolicite a nova data e faﾃｧa a atualizaﾃｧﾃ｣o do evento usando a tool <atualizar_evento>\n\nExemplo de mensagem:\n\n笨 Agendamento atualizado com sucesso!\n\nEnvie a data nova para o usuario \n\n</USO DA TOOL>\n\nSeguindo o padrﾃ｣o brasileiro de data e hora (DD/MM/AAAA e HH), o assistente opera no fuso horﾃ｡rio \"America/Sao_Paulo\". hora atual: <dateAndTime>\n\n    - Today is {{ $now.setLocale('en').weekdayLong }}, {{ $now.format('yyyy/MM/dd') }} - {{ $now.hour.toString().padStart(2, '0') }}:{{ $now.minute.toString().padStart(2, '0') }}\n\n    - Tomorrow is {{ $now.setLocale('en').plus(1, 'days').weekdayLong }}, {{ $now.plus(1, 'days').format('yyyy/MM/dd') }}\n\n    - The day after tomorrow is {{ $now.setLocale('en').plus(2, 'days').weekdayLong }}, {{ $now.plus(2, 'days').format('yyyy/MM/dd') }}\n\n    - {{ $now.setLocale('en').plus(3, 'days').weekdayLong }} is {{ $now.plus(3, 'days').format('yyyy/MM/dd') }}\n\n    - {{ $now.setLocale('en').plus(4, 'days').weekdayLong }} is {{ $now.plus(4, 'days').format('yyyy/MM/dd') }}\n\n    - {{ $now.setLocale('en').plus(5, 'days').weekdayLong }} is {{ $now.plus(5, 'days').format('yyyy/MM/dd') }}\n\n    - {{ $now.setLocale('en').plus(6, 'days').weekdayLong }} is {{ $now.plus(6, 'days').format('yyyy/MM/dd') }}\n\n  </dateAndTime> \n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        448,
        0
      ],
      "id": "981be4f3-b33c-4190-9897-944aa07d50e2",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4o-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        352,
        224
      ],
      "id": "e4abeaf5-b888-43c4-9cc1-6d627cb75d7b",
      "name": "OpenAI Chat Model"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $json.whatsapp }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        512,
        224
      ],
      "id": "86df4531-fc47-4a23-9586-066ce09f7052",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "calendar": {
          "__rl": true,
          "value": "pottoflow@gmail.com",
          "mode": "list",
          "cachedResultName": "pottoflow@gmail.com"
        },
        "start": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start', `data que o usuﾃ｡rio escolheu para o agendamento`, 'string') }}",
        "end": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End', `30 minutos a partir da data e hora que o usuﾃ｡rio escolheu`, 'string') }}",
        "useDefaultReminders": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Use_Default_Reminders', `Um lembrete de 30 minutos antes e um lembrete um dia antes do evento `, 'boolean') }}",
        "additionalFields": {
          "description": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Description', `Adicione na descriﾃｧﾃ｣o um pequeno resumo da conversa e a intenﾃｧﾃ｣o do usuﾃ｡rio `, 'string') }}",
          "summary": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Summary', `Altere o titulo do agendamento para o [nome completo do usuﾃ｡rio] `, 'string') }}"
        }
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.3,
      "position": [
        704,
        240
      ],
      "id": "7f83df19-c943-4913-9e74-292db644ad3f",
      "name": "criar_evento"
    },
    {
      "parameters": {
        "operation": "getAll",
        "calendar": {
          "__rl": true,
          "value": "pottoflow@gmail.com",
          "mode": "list",
          "cachedResultName": "pottoflow@gmail.com"
        },
        "timeMin": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('After', `Data do inicio do evento escolhido pelo usuﾃ｡rio`, 'string') }}",
        "timeMax": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Before', `Data apﾃｳs uma semana da data selecionada pelo usuﾃ｡rio `, 'string') }}",
        "options": {}
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.3,
      "position": [
        848,
        240
      ],
      "id": "e619019e-48b7-436c-b4aa-7b9571e0ded2",
      "name": "buscar_evento"
    },
    {
      "parameters": {
        "operation": "delete",
        "calendar": {
          "__rl": true,
          "value": "pottoflow@gmail.com",
          "mode": "list",
          "cachedResultName": "pottoflow@gmail.com"
        },
        "eventId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Event_ID', `event id deve ser excluﾃｭdo, gerado na conversa do agendamento com o usuﾃ｡rio`, 'string') }}",
        "options": {}
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.3,
      "position": [
        1008,
        240
      ],
      "id": "54cb2773-f45b-40be-bdd3-76ea842f1496",
      "name": "deletar_evento",
      "notes": "Desenvolvido por Potto Flow"
    },
    {
      "parameters": {
        "operation": "update",
        "calendar": {
          "__rl": true,
          "value": "pottoflow@gmail.com",
          "mode": "list",
          "cachedResultName": "pottoflow@gmail.com"
        },
        "eventId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Event_ID', `atualizar o evento do usuﾃ｡rio`, 'string') }}",
        "updateFields": {}
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.3,
      "position": [
        1168,
        240
      ],
      "id": "3a7d1203-00fb-4b17-b507-04e9d82e170c",
      "name": "atualizar_evento"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.z-api.io/instances/3DE8B7E0C5AB203F004E4E20A388CB1E/token/D6C681645D55E6E8104FB950/send-text",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "phone",
              "value": "={{ $('simplificaﾃｧﾃ｣o de dados').item.json.whatsapp }}"
            },
            {
              "name": "message",
              "value": "={{ $json.output }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        992,
        0
      ],
      "id": "ac3a1faa-ebaa-42b2-9755-a7c5135370b1",
      "name": "HTTP Request"
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "updatedAt": "2025-12-17T12:21:15.312Z",
      "createdAt": "2025-12-17T12:21:15.312Z",
      "role": "workflow:owner",
      "workflowId": "xOIJMptdvsIzKn68",
      "projectId": "o60HadikmqrvYZ9Z"
    }
  ],
  "staticData": null,
  "tags": [
    {
      "updatedAt": "2025-12-11T21:49:57.103Z",
      "createdAt": "2025-12-11T21:49:57.103Z",
      "id": "jVJBpv1Zg5iwH5ja",
      "name": "Potto Flow - Aula"
    }
  ],
  "triggerCount": 0,
  "updatedAt": "2025-12-17T12:21:15.312Z",
  "versionId": "f15c9d39-e6e6-4dfe-890f-c8210f8a51c6"
}
{
  "active": false,
  "activeVersion": null,
  "activeVersionId": null,
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "tool_visualizar_gastos": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "tool_criar_gasto": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "tool_atualizar_gasto": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "tool_deletar_gastos": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "tool_somar_gastos": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-12-17T12:25:45.097Z",
  "id": "XMhKlJARpgP1oRIN",
  "isArchived": false,
  "meta": null,
  "name": "Potto Flow - Agente financeiro (supabase)",
  "nodes": [
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.1,
      "position": [
        0,
        0
      ],
      "id": "7a12f638-7391-4848-9011-c75d30014a91",
      "name": "When chat message received",
      "webhookId": "690d2258-7ae3-483d-966e-408c93a42246"
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "=<instru√ß√µes>\n\nAtue como um Assistente Financeiro Inteligente, especializado no gerenciamento de registros de gastos dentro do Supabase. Sua principal fun√ß√£o √© ajudar o usu√°rio a visualizar, adicionar, atualizar, deletar e somar despesas de forma eficiente.\n\nSempre que o usu√°rio solicitar, ative a ferramenta apropriada para realizar a a√ß√£o desejada. Siga as instru√ß√µes abaixo cuidadosamente para garantir precis√£o e clareza na execu√ß√£o das tarefas.\n\nFuncionalidades Dispon√≠veis\n1. Visualizar Gastos (tool_visualizar_gastos)\nQuando ativada, exibe os registros de gastos cadastrados, incluindo:\n‚úÖ Nome do gasto\n‚úÖ Tipo de gasto\n‚úÖ Valor do gasto\n\nRegras de Ativa√ß√£o:\nSe o usu√°rio quiser filtrar os resultados por tipo de gasto ou per√≠odo, pergunte quais crit√©rios ele deseja aplicar antes de chamar a ferramenta.\n\nCaso o usu√°rio n√£o especifique filtros, exiba todos os gastos dispon√≠veis.\n\n2. Adicionar Gasto (tool_criar_gasto)\nEssa ferramenta cria um novo registro de gasto na tabela do Supabase.\n\nPar√¢metros obrigat√≥rios para ativa√ß√£o:\nüîπ nome_gasto: Nome do gasto.\nüîπ valor_gasto: Valor do gasto.\nüîπ tipo_gasto: Classifica√ß√£o do gasto dentro das 6 categorias dispon√≠veis:\n\nMercado\n\nDivers√£o\n\nComida\n\nEduca√ß√£o\n\nAssinatura\n\nTransporte\n\nRegras de Ativa√ß√£o:\nCaso o usu√°rio n√£o informe o tipo de gasto, voc√™ deve classific√°-lo automaticamente com base no contexto da mensagem.\n\nAntes de cadastrar o gasto, confirme os detalhes com o usu√°rio e pe√ßa a aprova√ß√£o final antes de chamar a ferramenta.\n\n3. Editar Gasto (tool_atualizar_gasto)\nEssa ferramenta permite modificar um gasto existente.\n\nPasso a Passo para ativa√ß√£o:\n1Ô∏è‚É£ Pergunte qual gasto o usu√°rio deseja editar (nome exato).\n2Ô∏è‚É£ Para evitar erros, ative primeiro a ferramenta tool_visualizar_gastos para confirmar a exist√™ncia do registro.\n3Ô∏è‚É£ Confirme com o usu√°rio qual gasto ele deseja modificar antes de prosseguir.\n4Ô∏è‚É£ Ap√≥s obter o nome correto, permita que o usu√°rio especifique as altera√ß√µes desejadas (nome, valor ou tipo).\n5Ô∏è‚É£ Realize a atualiza√ß√£o e exiba as informa√ß√µes do gasto atualizado para garantir transpar√™ncia.\n\n4. Deletar Gasto (tool_deletar_gastos)\nEssa ferramenta remove um gasto do sistema.\n\nPasso a Passo para ativa√ß√£o:\n1Ô∏è‚É£ Pergunte qual gasto o usu√°rio deseja deletar (nome exato).\n2Ô∏è‚É£ Para evitar exclus√µes erradas, ative primeiro a ferramenta tool_visualizar_gastos para confirmar a exist√™ncia do registro.\n3Ô∏è‚É£ Confirme com o usu√°rio antes de executar a exclus√£o.\n4Ô∏è‚É£ Ap√≥s confirma√ß√£o, delete o gasto e informe que a remo√ß√£o foi conclu√≠da.\n\n5. Somar Gastos (tool_somar_gastos)\nEssa ferramenta calcula o total dos gastos cadastrados pelo usu√°rio.\n\nRegras de Ativa√ß√£o:\nSe o usu√°rio quiser calcular os gastos de um per√≠odo espec√≠fico ou por tipo, pergunte os crit√©rios antes de somar.\n\nCaso n√£o haja filtros, some todos os gastos registrados e exiba o valor total.\n\nRegras Gerais:\nSe o usu√°rio pedir algo amb√≠guo, pe√ßa mais detalhes antes de ativar qualquer ferramenta.\n\nSempre confirme a√ß√µes cr√≠ticas como adicionar, editar ou excluir gastos antes de execut√°-las.\n\nGaranta que todas as respostas sejam claras, objetivas e organizadas.\n\n</instru√ß√µes>"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        224,
        0
      ],
      "id": "58d323c9-4918-432d-8ac5-3a35e81c1260",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4o-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        128,
        224
      ],
      "id": "5d57cf2e-ead4-4b4e-a30e-db61497b9adf",
      "name": "OpenAI Chat Model"
    },
    {
      "parameters": {
        "operation": "getAll",
        "tableId": "Gastos",
        "returnAll": true
      },
      "type": "n8n-nodes-base.supabaseTool",
      "typeVersion": 1,
      "position": [
        688,
        224
      ],
      "id": "179d5321-c7be-48bf-9f0f-cb57dae4ac6d",
      "name": "tool_visualizar_gastos"
    },
    {
      "parameters": {
        "tableId": "Gastos",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "Nome",
              "fieldValue": "={{ $fromAI(\"nome_gasto\") }}"
            },
            {
              "fieldId": "Valor",
              "fieldValue": "={{ $fromAI(\"valor_gasto\") }}"
            },
            {
              "fieldId": "Tipo",
              "fieldValue": "={{ $fromAI(\"tipo_gasto\") }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabaseTool",
      "typeVersion": 1,
      "position": [
        512,
        224
      ],
      "id": "15da1a51-7c37-4ce0-a35c-a872da29709a",
      "name": "tool_criar_gasto"
    },
    {
      "parameters": {
        "operation": "update",
        "tableId": "Gastos",
        "filters": {
          "conditions": [
            {
              "keyName": "Nome",
              "condition": "eq",
              "keyValue": "={{ $fromAI(\"nome_gasto\") }}"
            }
          ]
        },
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "Nome",
              "fieldValue": "={{ $fromAI(\"nome_gasto\") }}"
            },
            {
              "fieldId": "Valor",
              "fieldValue": "={{ $fromAI(\"valor_gasto\") }}"
            },
            {
              "fieldId": "Tipo",
              "fieldValue": "={{ $fromAI(\"tipo_gasto\") }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabaseTool",
      "typeVersion": 1,
      "position": [
        880,
        224
      ],
      "id": "509b4009-65e4-421d-9f28-a5794f5184b6",
      "name": "tool_atualizar_gasto"
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        320,
        224
      ],
      "id": "6dae322a-56a5-4a2b-93a4-2437983e76a7",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "operation": "delete",
        "tableId": "Gastos",
        "filters": {
          "conditions": [
            {
              "keyName": "Nome",
              "condition": "eq",
              "keyValue": "={{ $fromAI(\"nome_gasto\") }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabaseTool",
      "typeVersion": 1,
      "position": [
        1088,
        224
      ],
      "id": "eac4245b-dd05-4cba-9e43-bb0a6af5459a",
      "name": "tool_deletar_gastos"
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.toolCalculator",
      "typeVersion": 1,
      "position": [
        1280,
        224
      ],
      "id": "d4f49aac-9773-4351-9639-5f68d2d15bfd",
      "name": "tool_somar_gastos"
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "updatedAt": "2025-12-17T12:25:45.097Z",
      "createdAt": "2025-12-17T12:25:45.097Z",
      "role": "workflow:owner",
      "workflowId": "XMhKlJARpgP1oRIN",
      "projectId": "o60HadikmqrvYZ9Z"
    }
  ],
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2025-12-17T12:25:45.097Z",
  "versionId": "6c0f860e-813f-4ac6-b3cc-07e95d536d52"
}
{
  "active": false,
  "activeVersion": null,
  "activeVersionId": null,
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Supabase buscar usuário": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Supabase criar usuário",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Supabase criar usuário": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Supabase buscar usuário",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mensagem Texto": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mensagem Audio": {
      "main": [
        [
          {
            "node": "Convert to File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch2": {
      "main": [
        [
          {
            "node": "Mensagem Texto",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mensagem Texto",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mensagem Audio",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Evolution API",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to File": {
      "main": [
        [
          {
            "node": "OpenAI",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Get many database pages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge1": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MCP_CRM_Notion": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Create a database page": {
      "main": [
        [
          {
            "node": "Switch2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Enviar texto",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Switch2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Create a database page",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get many database pages": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2026-01-02T18:17:01.436Z",
  "id": "bQQEJC7uG6d8uLJN",
  "isArchived": false,
  "meta": null,
  "name": "Agente SDR - CRM",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "770452ee-72fc-4e91-b24e-a89922ca64e4",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -2336,
        80
      ],
      "id": "9614a770-2405-4ab0-88a1-1aff541da74b",
      "name": "Webhook",
      "webhookId": "770452ee-72fc-4e91-b24e-a89922ca64e4"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "38973d0e-1b7c-4be5-ab79-06bb04d415cb",
              "name": "nome",
              "value": "={{ $json.body.data.pushName }}",
              "type": "string"
            },
            {
              "id": "a9c54093-0a48-45d3-9006-b532a1103cd0",
              "name": "whatsapp",
              "value": "={{ $json.body.data.key.remoteJid }}",
              "type": "string"
            },
            {
              "id": "cff009fd-f150-44cb-afb5-53710611a773",
              "name": "message",
              "value": "={{ $json.body.data.message.conversation }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2128,
        80
      ],
      "id": "5bb9095e-911c-4b51-9cc1-2f2913f60aa9",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "operation": "get",
        "tableId": "Agente CRM",
        "filters": {
          "conditions": [
            {
              "keyName": "whatsapp",
              "keyValue": "={{ $json.whatsapp }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -1904,
        80
      ],
      "id": "8e57afbe-0ba4-4274-8a0f-ef8c07cfdcc8",
      "name": "Supabase buscar usuário",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "2c9859ec-014e-46c0-89d7-961307f7b595",
              "leftValue": "={{ $json.id }}",
              "rightValue": "",
              "operator": {
                "type": "number",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -1696,
        80
      ],
      "id": "a2cad5d2-4f9c-455e-a39c-39e2355bffc7",
      "name": "If"
    },
    {
      "parameters": {
        "tableId": "Agente CRM",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "nome",
              "fieldValue": "={{ $('Edit Fields').item.json.nome }}"
            },
            {
              "fieldId": "whatsapp",
              "fieldValue": "={{ $('Edit Fields').item.json.whatsapp }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -1520,
        272
      ],
      "id": "509006dd-2a63-40f8-87df-6bb5a21a92dd",
      "name": "Supabase criar usuário"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.1,
      "position": [
        -1344,
        80
      ],
      "id": "0c878800-ab7d-41e2-9a41-b3b9d9902681",
      "name": "Merge"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "c1ce011b-bd95-468e-863e-f2076f644cf9",
              "name": "message",
              "value": "={{ $('Edit Fields').first().json.message }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        0,
        0
      ],
      "id": "0c4611cc-664a-4bd7-ab13-89e161d68eb4",
      "name": "Mensagem Texto"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "5efc6961-1ff7-4ef2-a772-7e9761592a3e",
              "name": "Audio",
              "value": "={{ $('Webhook').item.json.body.data.message.base64 }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        0,
        176
      ],
      "id": "53517f3e-abe8-4f51-abda-8206d2ba0fca",
      "name": "Mensagem Audio"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "id": "bc64f125-d93c-4d1d-97ae-65c0adb08b79",
                    "leftValue": "={{ $('Webhook').first().json.body.data.messageType }}",
                    "rightValue": "conversation",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "texto"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "id": "137aec3f-e95e-4d59-b9ba-1140f9fc4fb4",
                    "leftValue": "={{ $('Webhook').first().json.body.data.messageType }}",
                    "rightValue": "extendedTextMessage",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "texto"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 1
                },
                "conditions": [
                  {
                    "id": "137aec3f-e95e-4d59-b9ba-1140f9fc4fb4",
                    "leftValue": "={{ $('Webhook').first().json.body.data.messageType }}",
                    "rightValue": "audioMessage",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "audio"
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra",
          "renameFallbackOutput": "Outro"
        }
      },
      "id": "340beab6-5528-4569-acf5-86db603d063c",
      "name": "Switch2",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.1,
      "position": [
        -352,
        32
      ],
      "notesInFlow": false,
      "notes": "Desenvolvido por Potto Flow"
    },
    {
      "parameters": {
        "resource": "audio",
        "operation": "transcribe",
        "options": {
          "language": "pt"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        400,
        176
      ],
      "id": "afef993b-2f0d-4ce2-bcb5-a642af7479c4",
      "name": "OpenAI"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "Audio",
        "options": {
          "mimeType": "audio/mp4"
        }
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        224,
        176
      ],
      "id": "5608d4dc-783a-410c-828f-332f68ea326a",
      "name": "Convert to File"
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "potto-evo",
        "remoteJid": "={{ $('simplificação de dados').item.json.whatsapp }}",
        "messageText": "=Olá, não recebemos esse tipo de formato",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api.evolutionApi",
      "typeVersion": 1,
      "position": [
        0,
        400
      ],
      "id": "f709b8e5-5189-4a34-a258-73f6932a9017",
      "name": "Evolution API"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.1,
      "position": [
        848,
        16
      ],
      "id": "c1336446-ae86-472e-809e-85c5d505ac2b",
      "name": "Merge1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0ef3cc0c-78ff-42c0-ad2a-934618b7c8ae",
              "name": "message",
              "value": "={{ $json.text }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        576,
        176
      ],
      "id": "712aa8ef-13f9-41b9-9cd7-d02e3815f192",
      "name": "Edit Fields1",
      "notes": "Desenvolvido por Potto Flow"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.message }}",
        "options": {
          "systemMessage": "=## Agente SDR - Agência Potto \nVocê é o Mari, uma Agente SDR da Potto, uma agência especializada na criação de Agentes IA.\nSeu papel é realizar o primeiro atendimento aos leads interessados, conduzindo uma conversa acolhedora e eficiente para entender o perfil do lead, qualificar sua demanda e encaminhá-lo corretamente para o time comercial que fará um atendimento humano.\nSua comunicação deve ser humana, empática, objetiva e consultiva — sempre focando em ajudar o lead a encontrar a melhor solução com IA.\n\n### Etapas do processo de atendimento\n\nApós o primeiro contato pergunte o e-mail e \n\nPara realizar a gestão dos leads e vendas, é utilizado um CRM no Notion com 4 etapas:\n1. Novo Lead: Aqui é quando o lead chega, você realizará o atendimento de todos novos leads. Seu papel é aquecer o lead, pegar seu e-mail e repassar para Atendimento Humano (Vendedor), depois que lead estiver pronto para comprar você utiliza a tool MCP_CRM_ fazendo um resumo da conversa com o lead e atualizará o status do lead no CRM para \"Atendimento Humano\".\n2. Atendimento Humano: Aqui é onde o Atendente Humano realiza o atendimento, você não precisa fazer nada.\n3. Perdido: Você deve encaminhar leads para essa etapa quando o lead não tiver mais interesse no serviço. Para isso utilize a tool MCP_CRM fazendo um resumo da conversa com o lead e atualize o status do lead no CRM para \"Perdido\". \n4. Convertido: O Atendente Humano coloca os leads aqui, você não precisa fazer nada.\n\n### Serviços Disponíveis da Agência Potto:\n1. Agente de SRD\nAutomatiza o primeiro atendimento, qualifica leads e encaminha os prontos para vendas.\n    - Valor (a partir de): R$ 4.000 - Tempo de implantação: 7 a 10 dias\n    - Retorno esperado: Redução de até 70% no tempo gasto pelo time comercial com leads desqualificados\n2. Agente de Vendas\n    - Valor (a partir de): R$ 7.000 - Tempo de implantação: 10 a 15 dias\n    - Retorno esperado: Aumento de até 30% na conversão de leads em negociação\n3. Diagnóstico IA para Funil de IA\n    - Valor (a partir de): R$ 2.500 Tempo de entrega: 3 dias\n    - Retorno esperado: Clareza sobre gargalos nos processos de ação com IA\n    - Observação estratégica: Recomendado como primeiro passo antes da implementação de qualquer agente. Ajuda a identificar onde a IA pode gerar maior impacto no funil.\n\n### Exemplos de perguntas para qualificação do lead:\n1. Qual principal dor da sua empresa?\n2. Você atua em qual setor e qual sua função na empresa?\n3. Deseja apenas entender mais ou já está pronto para receber uma proposta?\n\n## Processo de Qualificação e repasse para atendimento humano\nDepois que perceber que o lead está qualificado, quente ou pronto para comprar, você deve:\n- Solicitar o seu e-mail e ativar a tool MCP_CRM para atualizar o e-mail dentro do supabase e dentro do Notion\n- Ativar a tool MCP_CRM para selecionar o lead no banco de dados do notion e fazer atualização do status dele para “Atendimento Humano” e agregar um resumo da conversa. Assim o atendente humano Vendedor poderá seguir o atendimento e fechar a venda.\n- Diga ao Lead que um Especialista Humano irá prosseguir o atendimento para finalizar a contratação do serviço.\n\nCaso o lead não esteja mais interessado no serviço, você deve:\n- Ativar a tool MCP_CRM para atualizar o status do lead para “Finalizado” e criar um resumo da conversa.\n- Diga o lead que caso volte a ter interesse no serviço é só chamar!\n\n# Restrições\n- Adapte o fluxo da conversa conforme as necessidades do usuário, porém evite responder perguntas fora do seu papel, atenha-se a suas <instruções> e função;\n- Nunca invente informações, atenha-se apenas as suas informações fornecidas;\n- Crie somente um usuario novo dentro do Notion com o número de telefone \n- Não pergunte para o usuario se ele quer finalizar o atendimento faça isso automaticamente e siga o passo a passo\n\n# Variáveis\nData atual: {{ $now }}\n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        1104,
        16
      ],
      "id": "d2487ed1-0ede-4bd2-998d-984a77b2ff68",
      "name": "AI Agent",
      "notes": "Desenvolvido por Potto Flow"
    },
    {
      "parameters": {
        "sseEndpoint": "https://n8n-fila-hook.pottoflow.com.br/mcp/dvdsgfsd565545658",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
      "typeVersion": 1,
      "position": [
        1280,
        384
      ],
      "id": "d85dc0df-4416-4cd5-b135-77bf4bdd0628",
      "name": "MCP_CRM_Notion"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        896,
        384
      ],
      "id": "a83cc4ce-08a4-4cc3-8abf-1a88df4a5f05",
      "name": "OpenAI Chat Model"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Edit Fields').item.json.whatsapp }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        1088,
        384
      ],
      "id": "05bba4e8-ecf5-4d1a-b612-f3f7b9793af1",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "databaseId": {
          "__rl": true,
          "value": "260738f0-264a-8044-a441-daf26b06e99c",
          "mode": "list",
          "cachedResultName": "CRM ",
          "cachedResultUrl": "https://www.notion.so/260738f0264a8044a441daf26b06e99c"
        },
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Nome|title",
              "title": "={{ $('Edit Fields').first().json.nome }}"
            },
            {
              "key": "WhatsApp|rich_text",
              "textContent": "={{ $('Edit Fields').first().json.whatsapp }}"
            },
            {
              "key": "Status|select",
              "selectValue": "Novo Lead"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        -640,
        320
      ],
      "id": "eb55d4f0-592b-4089-9627-6ec34f6bb271",
      "name": "Create a database page"
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "potto-evo",
        "remoteJid": "={{ $('Edit Fields').item.json.whatsapp }}",
        "messageText": "={{ $json.output }}",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api.evolutionApi",
      "typeVersion": 1,
      "position": [
        1456,
        16
      ],
      "id": "764c1318-168b-41ab-a807-a4006cb25b9c",
      "name": "Enviar texto"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "13c098c6-4443-484b-a07a-cad65d2bd884",
              "leftValue": "={{ $json.property_whats_app }}",
              "rightValue": "={{ $('Edit Fields').first().json.whatsapp }}",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -960,
        80
      ],
      "id": "0abcc854-e8ee-431a-a0cb-1525fbb3967e",
      "name": "If1",
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": {
          "__rl": true,
          "value": "260738f0-264a-8044-a441-daf26b06e99c",
          "mode": "list",
          "cachedResultName": "CRM ",
          "cachedResultUrl": "https://www.notion.so/260738f0264a8044a441daf26b06e99c"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        -1136,
        80
      ],
      "id": "1be44882-f63e-4793-b610-63aaa6bf6268",
      "name": "Get many database pages",
      "alwaysOutputData": true,
      "notes": "Desenvolvido por Potto Flow"
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "shared": [
    {
      "updatedAt": "2026-01-02T18:17:01.436Z",
      "createdAt": "2026-01-02T18:17:01.436Z",
      "role": "workflow:owner",
      "workflowId": "bQQEJC7uG6d8uLJN",
      "projectId": "o60HadikmqrvYZ9Z"
    }
  ],
  "staticData": null,
  "tags": [
    {
      "updatedAt": "2025-12-11T21:49:57.103Z",
      "createdAt": "2025-12-11T21:49:57.103Z",
      "id": "jVJBpv1Zg5iwH5ja",
      "name": "Potto Flow - Aula"
    }
  ],
  "triggerCount": 0,
  "updatedAt": "2026-01-02T18:17:01.436Z",
  "versionId": "4a608806-2464-406a-b5e9-66dd9e80cdb6"
}